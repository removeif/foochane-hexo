---
title: SSR安装教程2
summary: 
author: foochane
top: false
cover: false
categories: linux
date: 2019-08-09 18:26
urlname: 2019080901
tags:
  - linux
---

## 1 安装SSR
### 1.1 下载安装脚本
```
wget -N --no-check-certificate https://raw.githubusercontent.com/ToyoDAdoubi/doubi/master/ssr.sh

```

如果失效见：https://raw.githubusercontent.com/foochane/doubi/master/ssr.sh

## 1.2 添加可执行权限
```
chmod +x ssr.sh

```

## 1.3 运行脚本
```
bash ssr.sh

```

## 1.4 配置过程

过一会会出现以下界面
```
1. 安装 ShadowsocksR
2. 更新 ShadowsocksR
3. 卸载 ShadowsocksR
4. 安装 libsodium(chacha20)
————————————
5. 查看 账号信息
6. 显示 连接信息
7. 设置 用户配置
8. 手动 修改配置
9. 清零 已用流量
————————————
10. 启动 ShadowsocksR
11. 停止 ShadowsocksR
12. 重启 ShadowsocksR
13. 查看 ShadowsocksR 日志
————————————
14. 其他功能
15. 升级脚本

当前状态: 已安装 并 已启动
请输入数字 [1-15]：
直接输入1，按回车开始配置
```

```
输入IP或者直接回车
用户名随便输一个，自己能辨别就行，以后添加用户的时候不能用一样的名字
端口自己随便设置一个，一般四位数
设置一个密码
加密方式选1.none
协议选5. auth_chain_a
混淆选1. plain
是否兼容原版，输入n
根据自己的需求，填写 SSR 账号速度、流量上限的限制。不做限制则一路回车
禁用端口那里如果只专们用来做 SSR 的，点击回车键，默认即可

```


## 2 安装客户端：
```
sudo apt install libcanberra-gtk-module libcanberra-gtk3-module gconf2 gconf-service libappindicator1

# 如果失效：https://raw.githubusercontent.com/foochane/electron-ssr-backup/master/0.2.5App/electron-ssr-0.2.5.deb
wget -c https://raw.githubusercontent.com/qingshuisiyuan/electron-ssr-backup/master/0.2.5App/electron-ssr-0.2.5.deb


#安装
dpkg -i 0.2.5App/electron-ssr-0.2.5.deb
``` 

## 3 开启BBR加速
### 3.1 查看当前内核信息：
```
# uname -r
3.10.0-693.el7.x86_64

```

可以看出，CentOS7默认自带的内核都是3.10.x，要启用BBR，我们要更换成4.9+内核版本，下面开始，更换内核。

### 3.2 启用elrepo源：
```
rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org
rpm -Uvh http://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm
```
### 3.3 安装Linux主线版本内核：
```
yum --enablerepo=elrepo-kernel install kernel-ml -y

```

安装之后，查看内核列表：

```
rpm -qa | grep kernel
```
查看是否有4.9+的输出，如果有，则证明安装成功了：
```
# rpm -qa | grep kernel
kernel-3.10.0-693.el7.x86_64
kernel-tools-libs-3.10.0-693.5.2.el7.x86_64
kernel-3.10.0-693.5.2.el7.x86_64
kernel-tools-3.10.0-693.5.2.el7.x86_64
kernel-ml-4.13.11-1.el7.elrepo.x86_64
```
我这里是最后以后就是刚安装的新内核。

查看所有可引导的内核列表：
```
# egrep ^menuentry /etc/grub2.cfg | cut -f 2 -d \'
CentOS Linux (4.13.11-1.el7.elrepo.x86_64) 7 (Core)
CentOS Linux 7 Rescue 6546b7b4c5c34716a6344417a6bffac6 (3.10.0-693.5.2.el7.x86_64)
CentOS Linux (3.10.0-693.5.2.el7.x86_64) 7 (Core)
CentOS Linux (3.10.0-693.el7.x86_64) 7 (Core)
CentOS Linux (0-rescue-d1f142097d497f24c021d7de9b81cab4) 7 (Core)
```
看输出结果，第一个就是刚安装的，将其设置为默认启动内核就好了：

```
grub2-set-default 0

```
注意，上面最后一个0是4.9+内核所在的位置，从0开始数，第一个就是0，第二个是1，以此类推就好了。

设置完之后，重启系统：

```
reboot
```

重新登陆服务器，查看当前使用的内核信息：

```
# uname -r
4.13.11-1.el7.elrepo.x86_64
```
可以看出，已经是4.13.x内核了，符合启用BBR的要求，接下来就是启用BBR了。

### 3.4 让BBR生效
输入以下几行命令，让BBR生效：
```
echo "net.core.default_qdisc=fq" >> /etc/sysctl.conf
echo "net.ipv4.tcp_congestion_control=bbr" >> /etc/sysctl.conf
sysctl -p
```
查看结果：
```
sysctl -n net.ipv4.tcp_congestion_control
lsmod | grep bbr
```
如果两行命令都有BBR字样输出，则代表BBR启用成功。可以用Nginx下载个文件体验一下BBR带来的加速了。


## 参考链接：

- https://www.lovexyh.top/archives/129

- https://github.com/qingshuisiyuan/electron-ssr-backup/blob/master/Ubuntu.md

- https://elsenow.com/post/centos-7-enable-google-bbr.html


## 配置信息：

```
===================================================

 ShadowsocksR账号 配置信息：

 I  P	    : 170.106.5.40
 端口	    : 2333
 密码	    : ssr0808
 加密	    : none
 协议	    : auth_chain_a
 混淆	    : plain
 设备数限制 : 0(无限)
 单线程限速 : 0 KB/S
 端口总限速 : 0 KB/S

 SSR   链接 : ssr://MTcwLjEwNi41LjQwOjIzMzM6YXV0aF9jaGFpbl9hOm5vbmU6cGxhaW46YzNOeU1EZ3dPQQ 
 SSR 二维码 : http://doub.pw/qr/qr.php?text=ssr://MTcwLjEwNi41LjQwOjIzMzM6YXV0aF9jaGFpbl9hOm5vbmU6cGxhaW46YzNOeU1EZ3dPQQ 
 
  提示: 
 在浏览器中，打开二维码链接，就可以看到二维码图片。
 协议和混淆后面的[ _compatible ]，指的是 兼容原版协议/混淆。

===================================================
```